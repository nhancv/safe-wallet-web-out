"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1577],{5813:(e,t,a)=>{a.d(t,{a:()=>r});let r={THRESHOLD:"The threshold of a Safe Account specifies how many signers need to confirm a Safe Account transaction before it can be executed.",REVIEW_WINDOW:"A period that begins after a recovery is submitted on-chain, during which the Safe Account signers can review the proposal and cancel it before it is executable.",PROPOSAL_EXPIRY:"A period after which the recovery proposal will expire and can no longer be executed."}},12668:(e,t,a)=>{a.d(t,{E8:()=>n,M8:()=>o,aG:()=>s,uF:()=>c});var r=a(63388),n=function(e){return e.PROCESSING_BY_SMART_CONTRACT_WALLET="PROCESSING_BY_SMART_CONTRACT_WALLET",e.PROCESSING="PROCESSING",e.PROCESSED="PROCESSED",e.SUCCESS="SUCCESS",e.FAILED="FAILED",e.REVERTED="REVERTED",e}({}),o=function(e){return e.PROPOSAL="PROPOSAL",e.EXECUTION="EXECUTION",e.SKIP_EXPIRED="SKIP_EXPIRED",e}({});let i=new r.A,s=i.dispatch.bind(i),c=i.subscribe.bind(i);Object.values(n).forEach(e=>{c(e,t=>{console.info("Recovery ".concat(e," event received"),t)})})},12818:(e,t,a)=>{a.d(t,{Z:()=>l,r:()=>d});var r=a(7008),n=a(96049),o=a(9175),i=a(22084),s=a(10996),c=a(48199);function l(e){var t;let{safe:a,newThreshold:c,newOwners:l}=e,d=(0,n.getSafeSingletonDeployment)({network:a.chainId,version:null!==(t=a.version)&&void 0!==t?t:void 0});if(!d)throw Error("Safe deployment not found");let u=new r.KA(d.abi),h=a.owners.map(e=>e.value),x=l.filter(e=>!h.some(t=>(0,s.xU)(t,e.value))).map(e=>e.value),E=h.filter(e=>!l.some(t=>(0,s.xU)(t.value,e))),v=c!==a.threshold,A=[];for(let e=0;e<Math.max(x.length,E.length);e++){let t=x[e],a=E[e],r=(()=>{let e=h.findIndex(e=>(0,s.xU)(e,a));return 0===e?o.SENTINEL_ADDRESS:h[e-1]})();if(a&&t){let n=u.encodeFunctionData("swapOwner",[r,a,t]);A.push(n),h=h.map(t=>(0,s.xU)(t,a)?x[e]:t)}else if(t){let e=Math.min(c,h.length+1),a=u.encodeFunctionData("addOwnerWithThreshold",[t,e]);A.push(a),v=!1,h.push(t)}else if(a){let e=Math.min(c,h.length-1),t=u.encodeFunctionData("removeOwner",[r,a,e]);A.push(t),v=!1,h=h.filter(e=>!(0,s.xU)(e,a))}}return v&&A.push(u.encodeFunctionData("changeThreshold",[c])),A.map(e=>({to:a.address.value,value:"0",operation:i.OperationType.Call,data:e}))}async function d(e,t){let a=(0,c.k)(c.v.DELAY,e.address,t),r=e.args.queueNonce+1n;return{to:await a.getAddress(),value:"0",operation:i.OperationType.Call,data:a.interface.encodeFunctionData("setTxNonce",[r])}}},20738:(e,t,a)=>{a.d(t,{Cw:()=>u,Rp:()=>x,rt:()=>h});var r=a(48199),n=a(88683),o=a(32294),i=a(8694),s=a(28729),c=a(7602),l=a(72207),d=a(51458);function u(e,t){let a=(0,n.Ay)(),{safe:l}=(0,s.A)(),u=(0,o.vH)(),h=(0,d.f)();return(0,i.A)(async()=>{if(!h||!t||!a||!u||!e)return;let n=(0,c.b)(a,l.chainId,u),o=(0,r.k)(r.v.DELAY,e,n),i=await n.getSigner();return o.connect(i).execTransactionFromModule.staticCall(t.data.to,t.data.value,t.data.data,t.data.operation)},[h,t,a,u,l.chainId,e])}function h(e){let t=(0,n.Ay)(),{safe:a}=(0,s.A)(),d=(0,o.vH)(),{isExecutable:u}=(0,l.y)(e);return(0,i.A)(async()=>{if(!u||!(null==t?void 0:t.address)||!d)return;let n=(0,c.b)(t,a.chainId,d),o=(0,r.k)(r.v.DELAY,e.address,n),i=await n.getSigner(),s=o.connect(i),{to:l,value:h,data:x,operation:E}=e.args;return await s.executeNextTx.staticCall(l,h,x,E),!0},[u,e.address,e.args,a.chainId,t,d])}function x(e){let t=(0,n.Ay)(),{safe:a}=(0,s.A)(),d=(0,o.vH)(),{isExpired:u}=(0,l.y)(e);return(0,i.A)(async()=>{if(!u||!(null==t?void 0:t.address)||!d)return;let n=(0,c.b)(t,a.chainId,d),o=(0,r.k)(r.v.DELAY,e.address,n),i=await n.getSigner(),s=o.connect(i);return await s.skipExpired.staticCall(),!0},[u,e.address,a.chainId,t,d])}},24365:(e,t,a)=>{a.d(t,{_:()=>x,_L:()=>h,wQ:()=>u});var r=a(48199),n=a(22510),o=a(12668),i=a(79651),s=a(76870),c=a(7639);async function l(e){let{provider:t,chainId:a,delayModifierAddress:n,signerAddress:o}=e,i=await (0,c.tA)(a,o),l=await (0,s.RF)(t);return{isUnchecked:i,delayModifier:(0,r.k)(r.v.DELAY,n,l).connect(l)}}function d(e){let{tx:t,...a}=e,r={...a,txHash:t.hash};(0,o.aG)(o.E8.PROCESSING,r),t.wait().then(e=>{(0,n.EB)(e)?(0,o.aG)(o.E8.REVERTED,{...r,error:Error("Transaction reverted by EVM")}):(0,o.aG)(o.E8.PROCESSED,r)}).catch(e=>{(0,n.w1)(e)?(0,o.aG)(o.E8.PROCESSED,r):(0,o.aG)(o.E8.FAILED,{...r,error:(0,i.z)(e)})})}async function u(e){let t,{provider:a,safe:r,safeTx:n,delayModifierAddress:s,signerAddress:c,overrides:u}=e,{delayModifier:h,isUnchecked:x}=await l({provider:a,chainId:r.chainId,delayModifierAddress:s,signerAddress:c}),E=o.M8.PROPOSAL;try{t=await h.getTransactionHash(n.data.to,n.data.value,n.data.data,n.data.operation);let e=await h.execTransactionFromModule(n.data.to,n.data.value,n.data.data,n.data.operation,u);x?(0,o.aG)(o.E8.PROCESSING_BY_SMART_CONTRACT_WALLET,{moduleAddress:s,recoveryTxHash:t,txType:E,txHash:e.hash}):d({moduleAddress:s,recoveryTxHash:t,txType:E,tx:e})}catch(e){throw(0,o.aG)(o.E8.FAILED,{moduleAddress:s,recoveryTxHash:t,txType:E,error:(0,i.z)(e)}),e}}async function h(e){let{provider:t,chainId:a,args:r,delayModifierAddress:n,signerAddress:s,overrides:c}=e,{delayModifier:u,isUnchecked:h}=await l({provider:t,chainId:a,delayModifierAddress:n,signerAddress:s}),x=o.M8.EXECUTION;try{let e=await u.executeNextTx(r.to,r.value,r.data,r.operation,c);h?(0,o.aG)(o.E8.PROCESSING_BY_SMART_CONTRACT_WALLET,{moduleAddress:n,recoveryTxHash:r.txHash,txType:x,txHash:e.hash}):d({moduleAddress:n,recoveryTxHash:r.txHash,txType:x,tx:e})}catch(e){throw(0,o.aG)(o.E8.FAILED,{moduleAddress:n,recoveryTxHash:r.txHash,txType:x,error:(0,i.z)(e)}),e}}async function x(e){let{provider:t,chainId:a,delayModifierAddress:r,recoveryTxHash:n,signerAddress:s}=e,{delayModifier:c,isUnchecked:u}=await l({provider:t,chainId:a,delayModifierAddress:r,signerAddress:s}),h=o.M8.SKIP_EXPIRED;try{let e=await c.skipExpired();u?(0,o.aG)(o.E8.PROCESSING_BY_SMART_CONTRACT_WALLET,{moduleAddress:r,recoveryTxHash:n,txType:h,txHash:e.hash}):d({moduleAddress:r,recoveryTxHash:n,txType:h,tx:e})}catch(e){throw(0,o.aG)(o.E8.FAILED,{moduleAddress:r,recoveryTxHash:n,txType:h,error:(0,i.z)(e)}),e}}},71577:(e,t,a)=>{a.r(t),a.d(t,{RecoverAccountFlowFields:()=>et,default:()=>ea});var r=a(6029),n=a(85591),o=a(28381),i=a(88616),s=a(85205),c=a(74723),l=a(25167),d=a(55729),u=a(28729),h=a(12818),x=a(17358),E=a(48424),v=a(15013),A=a(80779),m=a(66072),S=a(18492),y=a(24365),g=a(96524),T=a(17787),f=a(42751),R=a(88683),w=a(96885),p=a(81173),C=a(79651),O=a(26247),_=a(29488),j=a(3952),I=a(20738),b=a(7639),N=a(23207),D=a(98079),P=a.n(D),L=a(47566),M=a(69629),G=a(68992),B=a(47347),F=a(83815),V=a(49104),Y=a(11353),k=a(30697),U=a(12002);function H(e){var t;let{params:a}=e,[n,o]=(0,d.useState)(!0),[i,D]=(0,d.useState)(),[H,z]=(0,d.useState)(!1),{setTxFlow:W}=(0,d.useContext)(p.P),{safeTx:K,safeTxError:X,setSafeTx:q,setSafeTxError:J}=(0,d.useContext)(m.H),{safe:$}=(0,u.A)(),Q=(0,R.Ay)(),Z=(0,w.Ay)(),[ee]=(0,j.A)(),ea=ee&&(0,f.pd)(ee,null!==(t=null==Q?void 0:Q.address)&&void 0!==t?t:""),[,er]=(0,I.Cw)(null==ea?void 0:ea.address,K),[en]=(0,Y.Ay)(),eo=(0,k._J)(),{data:ei}=(0,G.Em)(B.hT),[es]=(0,F.A)(null==K?void 0:K.data,void 0,null==ei?void 0:ei.txId),ec=Number(a[et.threshold]),el=a[et.owners];(0,d.useEffect)(()=>{let e=(0,h.Z)({safe:$,newThreshold:ec,newOwners:el});(e.length>1?(0,g.w6)(e):(0,g.NU)(e[0])).then(q).catch(J)},[ec,el,$,q,J]);let ed=async()=>{var e,t,a;if(!ea||!Z||!Q||!K||!en)return;o(!1),D(void 0),z(!1);let r=eo&&(0,U.jI)(eo,U.Gv.EIP1559)?{maxFeePerGas:null==en?void 0:null===(e=en.maxFeePerGas)||void 0===e?void 0:e.toString(),maxPriorityFeePerGas:null==en?void 0:null===(t=en.maxPriorityFeePerGas)||void 0===t?void 0:t.toString()}:{gasPrice:null==en?void 0:null===(a=en.maxFeePerGas)||void 0===a?void 0:a.toString()};try{await (0,y.wQ)({provider:Q.provider,safe:$,safeTx:K,delayModifierAddress:ea.address,signerAddress:Q.address,overrides:r}),(0,s.sx)({...c.a.SUBMIT_RECOVERY_ATTEMPT})}catch(t){let e=(0,C.z)(t);(0,b.jG)(e)?z(!0):((0,O.Oz)(O.I._804,e),D(e)),o(!0);return}W(void 0)},eu=!K||!n||!ea;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(A.A,{children:[(0,r.jsxs)(l.o5u,{mb:1,children:["This transaction will reset the Account setup, changing the signers",ec!==$.threshold?" and threshold":"","."]}),(0,r.jsx)(T.Y,{owners:el}),(0,r.jsx)(l.cGx,{className:P().nestedDivider,sx:{mt:"var(--space-2) !important"}}),(0,r.jsxs)(l.azJ,{my:1,children:[(0,r.jsx)(l.o5u,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"After recovery, Safe Account transactions will require:"}),(0,r.jsxs)(l.o5u,{children:[(0,r.jsx)("b",{children:a.threshold})," out of ",(0,r.jsxs)("b",{children:[a[et.owners].length," signers."]})]})]}),(0,r.jsx)(l.cGx,{className:P().nestedDivider}),es&&(0,r.jsx)(V.A,{txDetails:ei,safeTxData:null==K?void 0:K.data,...es}),(0,r.jsx)(L.X,{})]}),K&&(0,r.jsx)(v.A,{transaction:K,executionOwner:$.owners[0].value}),(0,r.jsx)(A.A,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.A,{variant:E.J.execute}),X&&(0,r.jsx)(x.A,{error:X,children:"This recovery will most likely fail. To save gas costs, avoid executing the transaction."}),er&&(0,r.jsx)(x.A,{error:er,children:"This transaction will most likely fail. To save gas costs, avoid executing the transaction."}),i&&(0,r.jsx)(x.A,{error:i,children:"Error submitting the transaction. Please try again."}),(0,r.jsx)(M.A,{}),(null==ea?void 0:ea.delay)!==void 0&&(0,r.jsxs)(x.A,{level:"info",children:["Recovery will be"," ",0n===ea.delay?"immediately possible":"possible in ".concat((0,_.ix)(Number(ea.delay)))," ","after this transaction is executed."]}),H&&(0,r.jsx)(N.A,{}),(0,r.jsx)(l.cGx,{className:P().nestedDivider}),(0,r.jsx)(l.waF,{sx:{mt:"var(--space-1) !important"},children:(0,r.jsx)(S.A,{allowNonOwner:!0,checkNetwork:!0,children:e=>(0,r.jsx)(l.$nd,{"data-testid":"execute-btn",variant:"contained",disabled:!e||eu,onClick:ed,children:n?"Execute":(0,r.jsx)(l.PaH,{size:20})})})})]})})]})}var z=a(78726),W=a(88992),K=a(59864),X=a(10240),q=a(57506),J=a(5813),$=a(21128),Q=a(10996),Z=a(12426);function ee(e){let{params:t,onSubmit:a}=e,{safeAddress:n,safe:o}=(0,u.A)(),i=(0,W.mN)({defaultValues:t,mode:"onChange"}),s=i.watch(et.owners),c=i.watch(et.threshold),{fields:l,append:h,remove:x}=(0,W.jz)({control:i.control,name:et.owners}),E=function(e){let{oldOwners:t,oldThreshold:a,newOwners:r,newThreshold:n}=e;return a===n&&t.length===r.length&&t.every(e=>r.some(t=>(0,Q.xU)(e.value,t.value)))}({oldOwners:o.owners,oldThreshold:o.threshold,newOwners:s,newThreshold:Number(c)});return(0,r.jsx)(W.Op,{...i,children:(0,r.jsx)("form",{onSubmit:i.handleSubmit(a),className:P().form,children:(0,r.jsxs)(A.A,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(z.o5u,{variant:"h6",gutterBottom:!0,sx:{fontWeight:700},children:"Add signer(s)"}),(0,r.jsx)(z.o5u,{variant:"body2",sx:{mb:1},children:"Set the new signer wallet(s) of this Safe Account and how many need to confirm a transaction before it can be executed."})]}),(0,r.jsx)(z.xA9,{container:!0,spacing:3,direction:"row",children:l.map((e,t)=>(0,r.jsxs)(d.Fragment,{children:[(0,r.jsx)(z.xA9,{item:!0,xs:11,children:(0,r.jsx)(q.A,{label:"Signer ".concat(t+1),name:"".concat(et.owners,".").concat(t,".value"),required:!0,fullWidth:!0,validate:e=>(0,Q.xU)(e,n)?"The Safe Account cannot own itself":s.filter(t=>t.value===e).length>1?"Already designated to be a signer":void 0},e.id)}),(0,r.jsx)(z.xA9,{item:!0,xs:1,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:t>0&&(0,r.jsx)(z.K0,{onClick:()=>x(t),children:(0,r.jsx)(z.Ahz,{component:X.A,inheritViewBox:!0})})})]},t))}),(0,r.jsx)(z.$nd,{onClick:()=>h({value:""}),variant:"text",startIcon:(0,r.jsx)(z.Ahz,{component:K.A,inheritViewBox:!0,fontSize:"small"}),sx:{alignSelf:"flex-start",my:1},children:"Add new signer"}),(0,r.jsx)(z.cGx,{className:P().nestedDivider}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(z.o5u,{variant:"h6",gutterBottom:!0,sx:{fontWeight:700},children:["Threshold",(0,r.jsx)(z.m_M,{title:J.a.THRESHOLD,arrow:!0,placement:"top",children:(0,r.jsx)("span",{children:(0,r.jsx)(z.Ahz,{component:$.A,inheritViewBox:!0,color:"border",fontSize:"small",sx:{verticalAlign:"middle",ml:.5}})})})]}),(0,r.jsx)(z.o5u,{variant:"body2",sx:{mb:1},children:"After recovery, Safe Account transactions will require:"})]}),(0,r.jsxs)(z.xA9,{container:!0,direction:"row",sx:{alignItems:"center",gap:2,mb:1},children:[(0,r.jsx)(z.xA9,{item:!0,children:(0,r.jsx)(W.xI,{control:i.control,name:et.threshold,render:e=>{let{field:t}=e;return(0,r.jsx)(z.A_L,{select:!0,...t,children:l.map((e,t)=>{let a=t+1;return(0,r.jsx)(z.Drp,{value:a,children:a},t)})})}})}),(0,r.jsx)(z.xA9,{item:!0,children:(0,r.jsxs)(z.o5u,{children:["out of ",l.length," signer",(0,Z.Tz)(l)]})})]}),E&&(0,r.jsx)(z.FcD,{severity:"error",sx:{border:"unset"},children:"The proposed Account setup is the same as the current one."}),(0,r.jsx)(z.cGx,{className:P().nestedDivider}),(0,r.jsx)(z.waF,{sx:{mt:"0 !important"},children:(0,r.jsx)(z.$nd,{"data-testid":"next-btn",variant:"contained",type:"submit",sx:{mt:1},disabled:E,children:"Next"})})]})})})}var et=function(e){return e.owners="owners",e.threshold="threshold",e}({});let ea=function(){let{data:e,step:t,nextStep:a,prevStep:c}=(0,i.A)({owners:[{value:""}],threshold:"1"},s.TL.START_RECOVERY),l=[(0,r.jsx)(ee,{params:e,onSubmit:t=>a({...e,...t})},0),(0,r.jsx)(H,{params:e},1)];return(0,r.jsx)(n.A,{title:0===t?"Start Account recovery":"Confirm transaction",subtitle:"Change Account settings",icon:o.A,step:t,onBack:c,hideNonce:!0,children:l})}},72207:(e,t,a)=>{a.d(t,{y:()=>s});var r=a(55729),n=a(42751),o=a(3087),i=a(10996);function s(e){let{validFrom:t,expiresAt:a,transactionHash:s,args:c,address:l}=e,{state:d,pending:u}=o.A.useStore()||{},h=null==d?void 0:d[0],x=h&&(0,n.sp)(h,s),E=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,[t,a]=(0,r.useState)(Date.now());return(0,r.useEffect)(()=>{let t=setInterval(()=>{a(t=>t+e)},e);return()=>{clearInterval(t)}},[e]),t}(6e4),v=Number(t)-E,A=v<=0,m=null!==a&&Number(a)<=Date.now(),S=!x||(0,i.xU)(x.address,l)&&BigInt(c.queueNonce)===BigInt(x.txNonce),y=!!(null==u?void 0:u[c.txHash]),g=A?0:Math.ceil(v/1e3);return{isNext:S,isExecutable:S&&A&&!m,isExpired:m,remainingSeconds:g,isPending:y}}},74723:(e,t,a)=>{a.d(t,{a:()=>o});var r=a(85205);let n="recovery",o={SETUP_RECOVERY:{action:"Start recovery setup",category:n},SELECT_RECOVERY_METHOD:{action:"Select recovery method",category:n},CONTINUE_WITH_RECOVERY:{action:"Continue with recovery method",category:n},CONTINUE_TO_WAITLIST:{action:"Continue to waitlist",category:n},SYGNUM_APP:{action:"Go to Sygnum app",category:n},RECOVERY_SETTINGS:{action:"Recovery settings",category:n,event:r.Bx.META},EDIT_RECOVERY:{action:"Start edit recovery",category:n},REMOVE_RECOVERY:{action:"Start recovery removal",category:n},START_RECOVERY:{action:"Start recovery proposal",category:n},CANCEL_RECOVERY:{action:"Start recovery cancellation",category:n},SHOW_ADVANCED:{action:"Show advanced recovery settings",category:n},DISMISS_PROPOSAL_CARD:{action:"Dismiss recovery proposal card",category:n},LEARN_MORE:{action:"Recovery info click",category:n},GO_BACK:{action:"Recovery cancellation back",category:n},GIVE_US_FEEDBACK:{action:"Recovery feedback click",category:n,event:r.Bx.CLICK},CHECK_RECOVERY_PROPOSAL:{action:"Check recovery proposal",category:n},SUBMIT_RECOVERY_CREATE:{action:"Submit recovery setup",category:n,event:r.Bx.META},SUBMIT_RECOVERY_EDIT:{action:"Submit recovery edit",category:n,event:r.Bx.META},SUBMIT_RECOVERY_REMOVE:{action:"Submit recovery remove",category:n,event:r.Bx.META},SUBMIT_RECOVERY_ATTEMPT:{action:"Submit recovery attempt",category:n,event:r.Bx.META},SUBMIT_RECOVERY_CANCEL:{action:"Submit recovery cancel",category:n,event:r.Bx.META}}}}]);
//# sourceMappingURL=1577.feebd00b7b4388cf.js.map