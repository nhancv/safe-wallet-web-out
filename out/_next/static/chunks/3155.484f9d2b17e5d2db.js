(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3155],{2856:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var i=t(55729);let n="‼️ ",a=(e,s)=>{e&&(e.href=s)},r=e=>{document.title=e?n+document.title:document.title.replace(n,"")},l=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=()=>{r(t),a(e,t?"/favicons/favicon-dot.ico":s),t=!t};return i(),setInterval(i,300)},o=()=>{(0,i.useEffect)(()=>{let e;let s=document.querySelector('link[rel*="icon"]'),t=(null==s?void 0:s.href)||"",i=()=>{clearInterval(e),a(s,t),r(!1)},n=()=>{document.hidden?e=l(s,t):i()};return document.addEventListener("visibilitychange",n),n(),()=>{i(),document.removeEventListener("visibilitychange",n)}},[])}},4784:(e,s,t)=>{"use strict";t.d(s,{A:()=>d});var i=t(84865),n=t(55729),a=t(95797),r=t(8694),l=t(28729),o=t(41086);let d=e=>{var s,t;let[d,c]=(0,n.useState)(),{safe:h}=(0,l.A)(),u=null===(t=(0,a.A)().page)||void 0===t?void 0:null===(s=t.results)||void 0===s?void 0:s.filter(i.a).find(s=>s.messageHash===e),[g,m]=(0,r.A)(async()=>{if(e)return(0,o.t)(e,h.chainId)},[e,h.chainId,h.messagesTag]);return(0,n.useEffect)(()=>{c(null!=g?g:u)},[u,g]),[d,c,m]}},10759:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var i=t(6029),n=t(78726),a=t(21128),r=t(23651),l=t.n(r);let o=e=>{let{title:s,message:t,children:r,icon:o=a.A}=e;return(0,i.jsxs)("div",{"data-testid":"message-infobox",className:l().container,children:[(0,i.jsxs)("div",{className:l().message,children:[(0,i.jsx)(n.Ahz,{component:o,color:"info",inheritViewBox:!0,fontSize:"medium"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(n.o5u,{variant:"subtitle1",fontWeight:"bold",children:s}),(0,i.jsx)(n.o5u,{variant:"body2",children:t})]})]}),r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.cGx,{className:l().divider}),(0,i.jsx)("div",{children:r})]})]})}},23651:e=>{e.exports={container:"styles_container__sAIKm",message:"styles_message__G1Adl",details:"styles_details__m9_zQ",divider:"styles_divider__hXKbs"}},41086:(e,s,t)=>{"use strict";t.d(s,{A:()=>j,t:()=>f});var i=t(88683),n=t(26247),a=t(79651),r=t(44993),l=t(54926),o=t(77986),d=t(57212),c=t(10423),h=t(76870);let u=async e=>{let{provider:s,safe:t,message:i,origin:n=""}=e,r=(0,d.iD)(t,i);try{let e=await (0,h.Z3)(s),a=await (0,d.K_)(e,t,i),r=i;(0,d.nW)(i)&&(r=(0,c.mk)(i)),await (0,l.proposeSafeMessage)(t.chainId,t.address.value,{message:r,signature:a,origin:n})}catch(e){throw(0,o.hH)(o.Nd.PROPOSE_FAILED,{messageHash:r,error:(0,a.z)(e)}),e}(0,o.hH)(o.Nd.PROPOSE,{messageHash:r})},g=async e=>{let{provider:s,safe:t,message:i}=e,n=(0,d.iD)(t,i);try{let e=await (0,h.Z3)(s),a=await (0,d.K_)(e,t,i);await (0,l.confirmSafeMessage)(t.chainId,n,{signature:a})}catch(e){throw(0,o.hH)(o.Nd.CONFIRM_PROPOSE_FAILED,{messageHash:n,error:(0,a.z)(e)}),e}(0,o.hH)(o.Nd.CONFIRM_PROPOSE,{messageHash:n})};var m=t(55729),x=t(28729);let f=async(e,s)=>{let t;try{t={...await (0,l.getSafeMessage)(s,e),type:"MESSAGE"}}catch(e){throw(0,n.vV)(n.I._613,e),e}return t},j=(e,s,t,n,l,o)=>{let[d,c]=(0,m.useState)(),h=(0,i.Ay)(),{safe:j}=(0,x.A)();(0,m.useEffect)(()=>{let s;return(null==e?void 0:e.preparedSignature)&&(s=setTimeout(()=>(0,r.Q)(e,t,o,n),3e3)),()=>clearTimeout(s)},[e,j.chainId,t,o,n]);let v=(0,m.useCallback)(async()=>{if(h){c(void 0);try{if(e){if(await g({provider:h.provider,safe:j,message:s}),!n){o();return}let e=await f(t,j.chainId);return e&&setTimeout(()=>(0,r.Q)(e,t,o,n),3e3),e}{await u({provider:h.provider,safe:j,message:s,origin:l});let e=await f(t,j.chainId);return 1===j.threshold&&e&&setTimeout(()=>(0,r.Q)(e,t,o,n),3e3),e}}catch(e){c((0,a.z)(e))}}},[h,j,e,s,l,t,o,n]);return{submitError:d,onSign:v}}},44993:(e,s,t)=>{"use strict";t.d(s,{Q:()=>a});var i=t(77986);let n=e=>e.confirmationsSubmitted>=e.confirmationsRequired&&!!e.preparedSignature,a=async(e,s,t,a)=>{n(e)&&((0,i.hH)(i.Nd.SIGNATURE_PREPARED,{messageHash:s,requestId:a,signature:e.preparedSignature}),t())}},73155:(e,s,t)=>{"use strict";t.r(s),t.d(s,{AppTitle:()=>eA,default:()=>ey});var i=t(6029),n=t(85591),a=t(78726),r=t(30566),l=t(87505),o=t(55729),d=t(4876),c=t(49159),h=t(28729),u=t(94077),g=t(17358),m=t(88683),x=t(4784),f=t(96885),j=t(81173),v=t(16694),p=t(3046),A=t(13616),y=t(57212);let w=(e,s)=>{let t=(0,o.useMemo)(()=>"string"==typeof e?(0,A.MU)(e):e,[e]),i=(0,o.useMemo)(()=>(0,y.vB)(t),[t]),n=(0,o.useMemo)(()=>(0,y.iD)(s,t),[s,t]);return{decodedMessage:t,safeMessageMessage:i,safeMessageHash:n}};var b=t(41086),S=t(72197),_=t(32988),E=t.n(_),C=t(20053),M=t(95571),N=t.n(M);let I=e=>{let{children:s,className:t}=e;return(0,i.jsx)("div",{className:E()(N().container,t),children:(0,i.jsxs)("div",{className:N().message,children:[(0,i.jsx)(S.Ahz,{component:C.A,color:"success",inheritViewBox:!0,fontSize:"small"}),(0,i.jsx)(S.o5u,{variant:"body2",width:"100%",children:s})]})})};var k=t(2856),O=t(10759),T=t(2934),F=t(80779),P=t(44993),R=t(85205),V=t(56366),z=t(66072),H=t(60435);let B=()=>{let{isRiskConfirmed:e,isRiskIgnored:s}=(0,o.useContext)(H.C);return e||!s?null:(0,i.jsx)(g.A,{level:"warning",children:"Please acknowledge the risk before proceeding."})};var q=t(598),W=t(77194),D=t(7639),G=t(57187),L=t(73484),Q=t(48230),U=t.n(Q),J=t(72830),K=t(89099),X=t(47014),Y=t(91518),Z=t(18928),$=t(18492),ee=t(69629),es=t(89357);let et=e=>({confirmations:[],confirmationsRequired:e,confirmationsSubmitted:0,creationTimestamp:0,message:"",logoUri:null,messageHash:"",modifiedTimestamp:0,name:null,proposedBy:{value:""},status:"NEEDS_CONFIRMATION",type:"MESSAGE"}),ei=e=>{let{label:s,hashValue:t}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.o5u,{variant:"body2",sx:{fontWeight:700,mt:2},children:[s,":"]}),(0,i.jsx)(a.o5u,{"data-testid":"message-hash",variant:"body2",component:"div",children:(0,i.jsx)(d.A,{address:t,showAvatar:!1,shortAddress:!1,showCopyButton:!0})})]})},en=e=>{let{threshold:s}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.azJ,{sx:{textAlign:"center",mb:2},children:(0,i.jsx)(a.Ahz,{component:c.A,viewBox:"0 0 32 32",fontSize:"large"})}),(0,i.jsx)(a.o5u,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center"},children:"Confirm message"}),s>1&&(0,i.jsxs)(a.o5u,{variant:"body1",sx:{textAlign:"center",mb:2},children:["To sign this message, collect signatures from ",(0,i.jsxs)("b",{children:[s," signers"]})," of your Safe Account."]})]})},ea=e=>{let{isOwner:s,submitError:t}=e,n=(0,m.Ay)(),a=(0,f.Ay)(),r=n&&a?s?t&&(0,D.jG)(t)?"User rejected signing.":t?"Error confirming the message. Please try again.":null:"You are currently not a signer of this Safe Account and won't be able to confirm this message.":"No wallet is connected.";return r?(0,i.jsx)(g.A,{children:r}):null},er=e=>{let{hasSigned:s}=e,t=(0,f.Ay)();return s?(0,i.jsx)(I,{children:(0,i.jsxs)(a.xA9,{container:!0,direction:"row",sx:{justifyContent:"space-between"},children:[(0,i.jsx)(a.xA9,{item:!0,xs:7,children:"Your connected wallet has already signed this message."}),(0,i.jsx)(a.xA9,{item:!0,xs:4,children:(0,i.jsx)(a.$nd,{variant:"contained",size:"small",onClick:()=>{t&&(0,f.Kk)(t)},fullWidth:!0,children:"Switch wallet"})})]})}):null},el=e=>{let{isBlindSigningEnabled:s,isBlindSigningPayload:t}=e,n=(0,K.useRouter)(),r=n.query.safe?{safe:n.query.safe}:void 0;return t?(0,i.jsxs)(g.A,{level:s?"warning":"error",children:["This request involves"," ",(0,i.jsx)(a.N_E,{component:U(),href:{pathname:J.S.settings.security,query:r},children:"blind signing"}),", which can lead to unpredictable outcomes.",(0,i.jsx)("br",{}),s?"Proceed with caution.":(0,i.jsxs)(i.Fragment,{children:["If you wish to proceed, you must first"," ",(0,i.jsx)(a.N_E,{component:U(),href:{pathname:J.S.settings.security,query:r},children:"enable blind signing"}),"."]})]}):null},eo=e=>{let{safeMessage:s,onContinue:t}=e;return(0,i.jsxs)(F.A,{children:[(0,i.jsx)(a.o5u,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center"},children:"Message successfully signed"}),(0,i.jsx)(p.A,{msg:s,showOnlyConfirmations:!0,showMissingSignatures:!0}),(0,i.jsx)(a.waF,{children:(0,i.jsx)(a.$nd,{variant:"contained",color:"primary",onClick:t,disabled:!s.preparedSignature,children:"Continue"})})]})},ed=e=>{let{message:s,origin:t,requestId:n}=e,{setTxFlow:d}=(0,o.useContext)(j.P),{setSafeMessage:c}=(0,o.useContext)(z.H),{needsRiskConfirmation:f,isRiskConfirmed:A,setIsRiskIgnored:S}=(0,o.useContext)(H.C),{palette:_}=(0,r.A)(),{safe:E}=(0,h.A)(),C=(0,u.A)(),M=(0,m.Ay)();(0,k.A)();let{decodedMessage:N,safeMessageMessage:I,safeMessageHash:D}=w(s,E),[Q,U]=(0,x.A)(D),J=(0,es.Jv)({chainId:E.chainId,safeAddress:E.address.value,safeVersion:E.version}),K=(0,es._k)({message:N,safeVersion:E.version}),ed="string"==typeof N?N:JSON.stringify(N,null,2),ec=!!(null==Q?void 0:Q.confirmations.some(e=>{let{owner:s}=e;return s.value===(null==M?void 0:M.address)})),eh=(null==Q?void 0:Q.confirmations)&&Q.confirmations.length>0,eu=!!(null==Q?void 0:Q.preparedSignature),eg=(0,y.nW)(N),em=(0,y.LA)(N),ex=(0,G.GV)(L.ph),ef=!C||ec||!E.deployed||!ex&&em,{onSign:ej,submitError:ev}=(0,b.A)(Q,N,D,n,t,()=>d(void 0)),ep=async()=>{if(f&&!A){S(!0);return}let e=await ej();e&&U(e);let s=(null==e?void 0:e.confirmations.length)===1;(0,R.sx)({...s?V.V.CREATE:V.V.CONFIRM,label:V.p.typed_message})},eA=async()=>{Q&&await (0,P.Q)(Q,D,()=>d(void 0),n)};return(0,o.useEffect)(()=>{"string"!=typeof s&&c(s)},[s,c]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F.A,{children:(0,i.jsxs)(a.Wux,{children:[(0,i.jsx)(en,{threshold:E.threshold}),eg&&(0,i.jsx)(W.tH,{fallback:(0,i.jsx)("div",{children:"Error parsing data"}),children:(0,i.jsx)(q.A,{safeMessage:N})}),(0,i.jsx)(el,{isBlindSigningEnabled:ex,isBlindSigningPayload:em}),(0,i.jsxs)(a.o5u,{sx:{fontWeight:700,mt:2,mb:1},children:["Message: ",(0,i.jsx)(v.A,{text:ed})]}),(0,i.jsx)(T.O,{message:N,isInModal:!0}),(0,i.jsxs)(a.nD3,{sx:{mt:2},children:[(0,i.jsx)(a.Xo_,{"data-testid":"message-details",expandIcon:(0,i.jsx)(l.A,{}),children:"SafeMessage details"}),(0,i.jsxs)(a.ZiS,{children:[(0,i.jsx)(ei,{label:"SafeMessage",hashValue:I}),(0,i.jsx)(ei,{label:"SafeMessage hash",hashValue:D}),(0,i.jsx)(ei,{label:"Domain hash",hashValue:J}),(0,i.jsx)(ei,{label:"Message hash",hashValue:K})]})]}),(0,i.jsx)(a.azJ,{sx:{"&:not(:empty)":{mt:2}},children:(0,i.jsx)(Z.w1,{})})]})}),eu?(0,i.jsx)(eo,{onContinue:eA,safeMessage:Q}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(F.A,{children:[(0,i.jsx)(er,{hasSigned:ec}),(0,i.jsx)(O.A,{title:"Collect all the confirmations",message:n&&!eh?"Please keep this modal open until all signers confirm this message. Closing the modal will abort the signing request.":"The signature will be submitted to the requesting app when the message is fully signed.",children:(0,i.jsx)(p.A,{msg:null!=Q?Q:et(E.threshold),showOnlyConfirmations:!0,showMissingSignatures:!0,backgroundColor:_.info.background})}),eh&&(0,i.jsx)(O.A,{title:"Share the link with other owners",message:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.o5u,{sx:{mb:2},children:"The owners will receive a notification about signing the message. You can also share the link with them to speed up the process."}),(0,i.jsx)(X.A,{safeMessageHash:D,button:!0})]}),icon:Y.A}),(0,i.jsx)(ee.A,{}),(0,i.jsx)(ea,{isOwner:C,submitError:ev}),(0,i.jsx)(B,{}),!E.deployed&&(0,i.jsx)(g.A,{children:"Your Safe Account is not activated yet."})]}),(0,i.jsx)(F.A,{children:(0,i.jsx)(a.waF,{children:(0,i.jsx)($.A,{checkNetwork:!ef,children:e=>(0,i.jsx)(a.$nd,{variant:"contained",color:"primary",onClick:ep,disabled:!e||ef,children:"Sign"})})})})]})]})};var ec=t(54088),eh=t(5552),eu=t(85235),eg=t(74321),em=t(53902),ex=t(74809),ef=t(90190);let ej=(0,ef.id)("requestValidatorsExit(bytes)").slice(0,10),ev=(0,ef.id)("batchWithdrawCLFee(bytes)").slice(0,10),ep=e=>{let s={[ej]:"Withdraw request",[ev]:"Claim"};return null==e?void 0:e.map(e=>s[e.data.slice(0,10)]).filter(Boolean).join(" and ")},eA=e=>{let{name:s,logoUri:t,txs:n}=e,a=(0,G.GV)(eh.AN),r=s||"Sign message";return s===em.Lo&&(r=(0,ec.getSwapTitle)(a.tradeType,n)||r),s===ex.w5&&(r=ep(n)||r),(0,i.jsxs)(eu.azJ,{display:"flex",alignItems:"center",children:[(0,i.jsx)(eg.A,{src:t||"/images/apps/apps-icon.svg",alt:s||"The icon of the application",width:32,height:32}),(0,i.jsx)(eu.o5u,{variant:"h4",pl:2,fontWeight:"bold",children:r})]})},ey=e=>{let{...s}=e;return(0,i.jsx)(n.A,{title:"Confirm message",subtitle:(0,i.jsx)(eA,{name:s.name,logoUri:s.logoUri}),step:0,hideNonce:!0,isMessage:!0,children:(0,i.jsx)(W.tH,{fallback:(0,i.jsx)("div",{children:"Error signing message"}),children:(0,i.jsx)(ed,{...s})})})}},95571:e=>{e.exports={container:"styles_container__sq4dv",message:"styles_message__X3rNR",details:"styles_details___XV55"}}}]);
//# sourceMappingURL=3155.484f9d2b17e5d2db.js.map