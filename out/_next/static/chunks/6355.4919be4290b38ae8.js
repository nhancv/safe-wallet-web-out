"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6355],{86355:(e,n,i)=>{i.r(n),i.d(n,{SpendingLimitFields:()=>$,default:()=>q});var t=i(6029),l=i(55729),o=i(88992),d=i(78726);let s=(0,i(93944).A)((0,t.jsx)("path",{d:"M15.88 9.29 12 13.17 8.12 9.29a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.39-.39.39-1.02 0-1.41-.39-.38-1.03-.39-1.42 0"}),"ExpandMoreRounded");var r=i(22592),a=i(82642),u=i(57506),c=i(50293),m=i(32963),h=i(75698),x=i(80779),v=i(49907),f=i.n(v),j=i(73392),b=i(99363),p=i(30264);let A=(e,n)=>{try{let i=(0,r.XS)(e,null!=n?n:"Gwei");a.y.defaultAbiCoder().encode(["int96"],[i])}catch(n){return Number(e)>1?"Amount is too big":"Amount is too small"}},g=()=>{let e=(0,c.Ay)(),{balances:n}=(0,h.x)(),{onNext:i,data:r}=(0,l.useContext)(p.o3),a=(0,l.useMemo)(()=>(0,m.$c)(e),[e]),v=(0,o.mN)({defaultValues:r,mode:"onChange"}),{handleSubmit:g,watch:k,control:y}=v,T=k($.tokenAddress),I=T?n.items.find(e=>e.tokenInfo.address===T):void 0,E=(0,l.useCallback)(e=>(0,b.bA)(e)||(0,b.EE)(e,null==I?void 0:I.tokenInfo.decimals)||A(e,null==I?void 0:I.tokenInfo.decimals),[null==I?void 0:I.tokenInfo.decimals]);return(0,t.jsx)(x.A,{children:(0,t.jsx)(o.Op,{...v,children:(0,t.jsxs)("form",{onSubmit:g(i),children:[(0,t.jsx)(d.MJN,{fullWidth:!0,sx:{mb:3},children:(0,t.jsx)(u.A,{"data-testid":"beneficiary-section",name:$.beneficiary,label:"Beneficiary"})}),(0,t.jsx)(j.Ay,{balances:n.items,selectedToken:I,validate:E}),(0,t.jsx)(d.o5u,{variant:"h4",fontWeight:700,mt:3,children:"Reset Timer"}),(0,t.jsx)(d.o5u,{children:"Set a reset time so the allowance automatically refills after the defined time period."}),(0,t.jsxs)(d.MJN,{fullWidth:!0,className:f().select,children:[(0,t.jsx)(d.l1Y,{shrink:!1,children:"Time Period"}),(0,t.jsx)(o.xI,{rules:{required:!0},control:y,name:$.resetTime,render:e=>{let{field:n}=e;return(0,t.jsx)(d.l6P,{"data-testid":"time-period-section",...n,sx:{textAlign:"right",fontWeight:700},IconComponent:s,children:a.map(e=>(0,t.jsx)(d.Drp,{"data-testid":"time-period-item",value:e.value,sx:{overflow:"hidden"},children:e.label},e.value))})}})]}),(0,t.jsx)(d.waF,{children:(0,t.jsx)(d.$nd,{"data-testid":"next-btn",variant:"contained",type:"submit",children:"Next"})})]})})})};var k=i(30697),y=i(28729),T=i(31777),I=i(16865),E=i(17580),w=i(21934),S=i(85205),M=i(96524),N=i(25927),C=i(12426),D=i(4876),_=i(66072),R=i(99322),F=i(15486);let O=e=>{var n;let{onSubmit:i,children:o}=e,{data:s}=(0,l.useContext)(p.o3),r=(0,T.d4)(N.h4),{safe:a}=(0,y.A)(),u=(0,c.Ay)(),h=(0,k._J)(),{balances:x}=(0,w.A)(),{setSafeTx:v,setSafeTxError:f}=(0,l.useContext)(_.H),j=x.items.find(e=>e.tokenInfo.address===(null==s?void 0:s.tokenAddress)),{decimals:b}=(null==j?void 0:j.tokenInfo)||{},A=(0,l.useMemo)(()=>{var e;return(null===(e=(0,C.wy)((null==s?void 0:s.amount)||"0",null==j?void 0:j.tokenInfo.decimals))||void 0===e?void 0:e.toString())||"0"},[null==s?void 0:s.amount,null==j?void 0:j.tokenInfo.decimals]),g=(0,l.useMemo)(()=>r.find(e=>e.beneficiary===(null==s?void 0:s.beneficiary)&&e.token.address===(null==s?void 0:s.tokenAddress)),[r,s]);(0,l.useEffect)(()=>{h&&s&&(0,M.S0)(s,r,u,h,a.modules,a.deployed,b,g).then(v).catch(f)},[h,u,b,g,s,a.modules,a.deployed,v,f,r]);let O=(null==s?void 0:s.resetTime)==="0",P=(0,l.useMemo)(()=>{var e;return O?"One-time spending limit":null===(e=(0,m.$c)(u).find(e=>e.value===(null==s?void 0:s.resetTime)))||void 0===e?void 0:e.label},[O,null==s?void 0:s.resetTime,u]),W=g?(0,C.q5)(BigInt(null==g?void 0:g.amount),b):void 0,J=g?null===(n=(0,m.$c)(u).find(e=>e.value===(null==g?void 0:g.resetTimeMin)))||void 0===n?void 0:n.label:void 0;return(0,t.jsxs)(R.A,{onSubmit:()=>{(0,S.sx)({...S.kd.SPENDING_LIMIT.RESET_PERIOD,label:P}),i()},withDecodedData:!1,children:[j&&(0,t.jsx)(E.A,{amountInWei:A,tokenInfo:j.tokenInfo,title:"Amount",children:W&&W!==(null==s?void 0:s.amount)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.o5u,{"data-testid":"old-token-amount",color:"error",sx:{textDecoration:"line-through"},component:"span",children:W}),"→"]})}),(0,t.jsx)(F.A,{label:"Beneficiary",grid:!0,children:(0,t.jsx)(d.azJ,{"data-testid":"beneficiary-address",children:(0,t.jsx)(D.A,{address:(null==s?void 0:s.beneficiary)||"",shortAddress:!1,hasExplorer:!0,showCopyButton:!0,showAvatar:!1})})}),(0,t.jsx)(F.A,{label:"Reset time",grid:!0,children:g?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(I.A,{label:(0,t.jsxs)(t.Fragment,{children:[g.resetTimeMin!==(null==s?void 0:s.resetTime)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.o5u,{"data-testid":"old-reset-time",color:"error",component:"span",sx:{textDecoration:"line-through"},children:J})," → "]}),(0,t.jsx)(d.o5u,{component:"span",children:P})]}),isOneTime:"0"===g.resetTimeMin})}):(0,t.jsx)(I.A,{"data-testid":"spending-limit-label",label:P||"One-time spending limit",isOneTime:!!P&&O})}),g&&(0,t.jsx)(d.FcD,{severity:"warning",sx:{border:"unset"},children:(0,t.jsx)(d.o5u,{"data-testid":"limit-replacement-warning",fontWeight:700,children:"You are about to replace an existing spending limit"})}),o]})};var P=i(28381),W=i(9175),J=i(60082),L=i(96758),B=function(e){return e.beneficiary="beneficiary",e.resetTime="resetTime",e}(B||{});let $={...B,...j.pd},G={beneficiary:"",tokenAddress:W.ZERO_ADDRESS,amount:"",resetTime:"0"},q=()=>(0,t.jsx)(J.J,{icon:P.A,subtitle:"Spending limit",ReviewTransactionComponent:O,eventCategory:S.TL.SETUP_SPENDING_LIMIT,initialData:G,children:(0,t.jsx)(L.L,{title:"New transaction",children:(0,t.jsx)(g,{})})})}}]);
//# sourceMappingURL=6355.4919be4290b38ae8.js.map