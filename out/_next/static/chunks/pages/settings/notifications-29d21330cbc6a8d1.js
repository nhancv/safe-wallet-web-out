(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5742],{5404:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/notifications",function(){return n(26527)}])},21349:(e,t,n)=>{"use strict";var s=n(64285),r=n(21600),i=n(35584),a=n(26543);e.exports=i(function(e,t){return a(e)?s(e,r(t,1,a,!0)):[]})},21600:(e,t,n)=>{"use strict";var s=n(39088),r=n(44739);e.exports=function e(t,n,i,a,l){var o=-1,c=t.length;for(i||(i=r),l||(l=[]);++o<c;){var d=t[o];n>0&&i(d)?n>1?e(d,n-1,i,a,l):s(l,d):a||(l[l.length]=d)}return l}},26527:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ev});var s=n(6029),r=n(77328),i=n.n(r),a=n(85495),l=n(78726),o=n(48230),c=n.n(o),d=n(55729),u=n(28729),h=n(4876),x=n(44401),j=n(53034),f=n(52822),v=n(43255),p=n(90270),b=n.n(p),m=n(21349),g=n.n(m),y=n(50474),_=n.n(y),N=n(10996),A=n(30697),O=n(57187),S=n(85205),E=n(94046),I=n(56003),T=n(9319),w=n(88683),C=n(75026),k=n(45129),M=n(78850),G=n(34417),P=function(e){return e.WalletNotConnected="Please connect your wallet",e.SDKNotInitialized="SDK is not initialized yet",e.NotSafeOwner="Your connected wallet is not a signer of this Safe Account",e.SafeNotActivated="You need to activate the Safe before transacting",e}(P||{});let F=e=>{let{children:t,permission:n,permissionProps:r,noTooltip:i,checkNetwork:a=!1,allowUndeployedSafe:l=!1}=e,o=(0,w.Ay)(),c=(0,C.A)(),h=(0,k.A)(),x=(0,T.dl)(),j=(0,G.T)(n,...r?[r]:[]),{safe:f,safeLoaded:v}=(0,u.A)(),p=!f.deployed,b=(0,d.useMemo)(()=>o?!x&&v?"SDK is not initialized yet":p&&!l?"You need to activate the Safe before transacting":j?void 0:"Your connected wallet is not a signer of this Safe Account":"Please connect your wallet",[l,j,p,x,o,v]);return a&&h?t(!1):b?i?t(!1):(0,s.jsx)(M.m_M,{title:b,children:(0,s.jsx)("span",{onClick:o?void 0:c,children:t(!1)})}):t(!0)};var R=n(75262),W=n(33462),U=n.n(W),D=n(5172),L=n(52283),z=n(12426),B=n(76344);let H=(e,t)=>_()(b()(e,(e,n)=>{let s=t[n]?Object.keys(t[n]):[];return g()(e,s)}),e=>e.length>0),X=e=>Object.entries(e).reduce((e,t)=>{let[n,s]=t;return e[n]=Object.keys(s),e},{}),q=e=>{if(e)return Object.values(e).reduce((e,t)=>{let{chainId:n,safeAddress:s}=t;return e[n]||(e[n]=[]),e[n].push(s),e},{})},Q=(e,t)=>Object.entries(t).reduce((t,n)=>{let[s,r]=n;return e.find(e=>e.chainId===s)&&(t[s]=r),t},{}),K=(e,t,n)=>{let s=X(t),r=Array.from(new Set([...Object.keys(t||{}),...Object.keys(n||{}),...Object.keys(e||{})])),i={};for(let t of r){var a,l;let r=null!==(l=null==e?void 0:e[t])&&void 0!==l?l:[],o=(null===(a=s[t])||void 0===a?void 0:a.filter(e=>r.includes(e)))||[],c=Array.from(new Set([...(null==n?void 0:n[t])||[],...o,...r]));i[t]=c}return i},Y=e=>Object.values(e).reduce((e,t)=>e+=t.length,0),J=(e,t)=>0!==Object.entries(e).length&&Object.entries(e).every(e=>{let[n,s]=e,r=Object.keys(t).includes(n),i=null==s?void 0:s.every(e=>{var s;return null===(s=t[n])||void 0===s?void 0:s.includes(e)});return r&&i}),Z=(e,t)=>Object.entries(e).filter(e=>{let[,t]=e;return t.length>0}).reduce((e,n)=>{let[s,r]=n,i=!(null==t?void 0:t[s]),a=r.some(e=>{var n;return!(null==t?void 0:null===(n=t[s])||void 0===n?void 0:n.includes(e))});return(i||a)&&(e+=1),e},0),$=(e,t)=>Object.entries(e).some(e=>{let[n,s]=e;return s.some(e=>{var s;return!(null==t?void 0:null===(s=t[n])||void 0===s?void 0:s.includes(e))})}),V=(e,t)=>Object.entries(t||{}).some(t=>{let[n,s]=t;return s.some(t=>{var s;return!(null===(s=e[n])||void 0===s?void 0:s.includes(t))})}),ee=(e,t)=>{let n=Object.entries(e).reduce((e,n)=>{let[s,r]=n,i=r.filter(e=>{var n;return!(null==t?void 0:null===(n=t[s])||void 0===n?void 0:n.includes(e))});return i.length>0&&(e[s]=i),e},{});if(Object.values(n).some(e=>e.length>0))return n},et=(e,t)=>{if(!t)return;let n=Object.entries(t).reduce((t,n)=>{let[s,r]=n,i=r.filter(t=>{var n;return!(null===(n=e[s])||void 0===n?void 0:n.includes(t))});return i.length>0&&(t[s]=i),t},{});if(Object.values(n).some(e=>e.length>0))return n},en=(e,t,n)=>!!n&&t.length===n[e].length&&t.every(t=>{var s;return null===(s=n[e])||void 0===s?void 0:s.includes(t)}),es=()=>{let e=(0,A.Ay)(),t=(0,O.GV)(v.Qc),[n,r]=(0,d.useState)(!1),{address:i=""}=(0,w.Ay)()||{},[a]=(0,D.A)(i),o=(0,O.GV)(L.cv),{getAllPreferences:c}=(0,f.Hg)(),{unregisterDeviceNotifications:u,unregisterSafeNotifications:x,registerNotifications:p}=(0,j.r)(),{safesForRenewal:b}=(0,B.i)(),[m,g]=(0,d.useState)({}),y=(0,d.useMemo)(()=>q(c()),[c]);(0,d.useEffect)(()=>{let e=!0;return y&&e&&g(y),()=>{e=!1}},[y]);let _=(0,d.useMemo)(()=>{let n=H(K(a,o,y),t);return Q(e.configs,n)},[a,o,y,t,e.configs]),T=(0,d.useMemo)(()=>Y(_),[_]),C=(0,d.useMemo)(()=>J(_,m),[_,m]),k=(0,d.useMemo)(()=>Z(m,y),[y,m]),M=(0,d.useMemo)(()=>$(m,y)||V(m,y),[m,y]),G=async()=>{if(!M)return;if(r(!0),!await (0,I.m)()){r(!1);return}let e=[],t=K(ee(m,y),{},b);t&&e.push(p(t));let n=et(m,y);if(n){let t=Object.entries(n).flatMap(e=>{let[t,n]=e;return en(t,n,y)?u(t):n.map(e=>x(t,e))});e.push(...t)}await Promise.all(e),(0,S.sx)(E.j.SAVE_SETTINGS),r(!1)};return 0===T?(0,s.jsx)(l.o5u,{sx:{color:e=>{let{palette:t}=e;return t.primary.light}},children:i?"No owned Safes":"No wallet connected"}):(0,s.jsxs)(l.xA9,{container:!0,children:[(0,s.jsxs)(l.xA9,{item:!0,xs:12,display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[(0,s.jsxs)(l.o5u,{variant:"h4",fontWeight:700,display:"inline",children:["My Safes Accounts (",T,")"]}),(0,s.jsxs)(l.azJ,{display:"flex",alignItems:"center",children:[k>0&&(0,s.jsxs)(l.o5u,{display:"inline",mr:2,textAlign:"right",children:["We'll ask you to verify ownership of each Safe Account with your signature per chain"," ",k," time",(0,z.Tz)(k)]}),(0,s.jsx)(F,{permission:R.aX.EnablePushNotifications,children:e=>(0,s.jsx)(l.$nd,{variant:"contained",disabled:!M||!e||n,onClick:G,children:n?(0,s.jsx)(l.PaH,{size:20}):"Save"})})]})]}),(0,s.jsx)(l.xA9,{item:!0,xs:12,children:(0,s.jsxs)(l.tu9,{sx:{border:e=>{let{palette:t}=e;return"1px solid ".concat(t.border.light)}},children:[(0,s.jsx)(l.B8B,{children:(0,s.jsx)(l.ckQ,{disablePadding:!0,className:U().item,children:(0,s.jsxs)(l.Wj3,{onClick:()=>{g(()=>C?[]:Object.entries(_).reduce((e,t)=>{let[n,s]=t;return{...e,[n]:s}},{}))},dense:!0,children:[(0,s.jsx)(l.LaP,{className:U().icon,children:(0,s.jsx)(l.Sc0,{edge:"start",checked:C,disableRipple:!0})}),(0,s.jsx)(l.ZqK,{primary:"Select all",primaryTypographyProps:{variant:"h5"}})]})})}),(0,s.jsx)(l.cGx,{}),Object.entries(_).map((t,n,r)=>{var i;let[a,o]=t;if(0===o.length)return;let c=null===(i=e.configs)||void 0===i?void 0:i.find(e=>e.chainId===a),u=o.every(e=>{var t;return null===(t=m[a])||void 0===t?void 0:t.includes(e)});return(0,s.jsxs)(d.Fragment,{children:[(0,s.jsxs)(l.B8B,{children:[(0,s.jsx)(l.ckQ,{disablePadding:!0,className:U().item,children:(0,s.jsxs)(l.Wj3,{onClick:()=>{g(e=>({...e,[a]:u?[]:o}))},dense:!0,children:[(0,s.jsx)(l.LaP,{className:U().icon,children:(0,s.jsx)(l.Sc0,{edge:"start",checked:u,disableRipple:!0})}),(0,s.jsx)(l.ZqK,{primary:"".concat(null==c?void 0:c.chainName," Safe Accounts"),primaryTypographyProps:{variant:"h5"}})]})}),(0,s.jsx)(l.B8B,{disablePadding:!0,className:U().item,children:o.map(e=>{var t,n;let r=null!==(n=null===(t=m[a])||void 0===t?void 0:t.includes(e))&&void 0!==n&&n;return(0,s.jsx)(l.ckQ,{disablePadding:!0,children:(0,s.jsxs)(l.Wj3,{sx:{pl:7,py:.5},onClick:()=>{g(t=>{var n,s;return{...t,[a]:r?null===(n=t[a])||void 0===n?void 0:n.filter(t=>!(0,N.xU)(t,e)):[...null!==(s=t[a])&&void 0!==s?s:[],e]}})},dense:!0,children:[(0,s.jsx)(l.LaP,{className:U().icon,children:(0,s.jsx)(l.Sc0,{edge:"start",checked:r,disableRipple:!0})}),(0,s.jsx)(h.A,{avatarSize:36,prefix:null==c?void 0:c.shortName,address:e||"",shortAddress:!1,showName:!0,chainId:a},e)]})},e)})})]}),n!==r.length-1?(0,s.jsx)(l.cGx,{}):null]},a)})]})})]})};var er=n(94077),ei=n(94937),ea=n(72830);let el=()=>{let[e,t]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{"undefined"!=typeof navigator&&t(navigator.userAgent.includes("Mac"))},[]),e};var eo=n(88271),ec=n(69629),ed=n(6417),eu=n(60038);let eh=()=>{let{safe:e}=(0,u.A)(),[t,n]=(0,d.useState)(!1),{renewNotifications:r,needsRenewal:i}=(0,B.i)(),a=(0,ed.Dj)();if(!i||!a)return(0,s.jsx)(s.Fragment,{});let o=async()=>{n(!0),await r(),n(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.FcD,{severity:"warning",children:[(0,s.jsx)(l.o5u,{variant:"body2",fontWeight:700,mb:1,children:"Signature needed"}),(0,s.jsx)(l.o5u,{variant:"body2",children:eu.b})]}),(0,s.jsx)(l.azJ,{children:(0,s.jsx)(F,{permission:R.aX.EnablePushNotifications,checkNetwork:!t&&e.deployed,children:n=>(0,s.jsx)(l.$nd,{variant:"contained",size:"small",sx:{width:"200px"},onClick:o,disabled:!n||t||!e.deployed,children:"Sign now"})})})]})};var ex=n(38858);let ej=()=>{let{safe:e,safeLoaded:t}=(0,u.A)(),n=(0,er.A)(),r=el(),[i,a]=(0,d.useState)(!1),[o,v]=(0,d.useState)(!1),p=(0,l.DPo)(),b=(0,l.Ubj)(p.breakpoints.up("lg")),{updatePreferences:m,getPreferences:g,getAllPreferences:y}=(0,f.Hg)(),{unregisterSafeNotifications:_,unregisterDeviceNotifications:N,registerNotifications:A}=(0,j.r)(),O=g(e.chainId,e.address.value),I=t=>{v(!0),m(e.chainId,e.address.value,t),v(!1)},T=r||ei.HL,w=async()=>{if(a(!0),!O){await A({[e.chainId]:[e.address.value]}),(0,S.sx)(E.j.ENABLE_SAFE),a(!1);return}let t=y();1===(t?Object.values(t).filter(t=>{let{chainId:n}=t;return n===e.chainId}).length:0)?await N(e.chainId):await _(e.chainId,e.address.value),(0,S.sx)(E.j.DISABLE_SAFE),a(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.tu9,{sx:{p:4,mb:2},children:(0,s.jsxs)(l.xA9,{container:!0,spacing:3,children:[(0,s.jsx)(l.xA9,{item:!0,sm:4,xs:12,children:(0,s.jsx)(l.o5u,{variant:"h4",sx:{fontWeight:700},children:"Push notifications"})}),(0,s.jsx)(l.xA9,{item:!0,xs:!0,children:(0,s.jsxs)(l.xA9,{container:!0,sx:{gap:2.5,flexDirection:"column"},children:[(0,s.jsx)(eh,{}),(0,s.jsxs)(l.o5u,{children:["Enable push notifications for ",t?"this Safe Account":"your Safe Accounts"," in your browser with your signature. You will need to enable them again if you clear your browser cache. Learn more about push notifications ",(0,s.jsx)(eo.A,{href:ex.tF.PUSH_NOTIFICATIONS,children:"here"})]}),T&&(0,s.jsxs)(l.FcD,{severity:"info",className:U().macOsInfo,children:[(0,s.jsx)(l.o5u,{variant:"body2",sx:{fontWeight:700,mb:1},children:"For macOS users"}),(0,s.jsxs)(l.o5u,{variant:"body2",children:["Double-check that you have enabled your browser notifications under ",(0,s.jsx)("b",{children:"System Settings"})," >"," ",(0,s.jsx)("b",{children:"Notifications"})," > ",(0,s.jsx)("b",{children:"Application Notifications"})," (path may vary depending on OS version)."]})]}),t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.cGx,{}),(0,s.jsx)(ec.A,{action:"change your notification settings"}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)(h.A,{address:e.address.value,showCopyButton:!0,shortAddress:!b,showName:!0,hasExplorer:!0}),(0,s.jsx)(F,{permission:R.aX.EnablePushNotifications,checkNetwork:!i&&e.deployed,children:t=>(0,s.jsx)(l.ip9,{"data-testid":"notifications-switch",control:(0,s.jsx)(l.dOG,{checked:!!O,onChange:w}),label:O?"On":"Off",disabled:!t||i||!e.deployed})})]}),(0,s.jsx)(l.tu9,{className:U().globalInfo,variant:"outlined",children:(0,s.jsxs)(l.o5u,{variant:"body2",children:["Want to setup notifications for different or all Safe Accounts? You can do so in your"," ",(0,s.jsx)(c(),{href:ea.S.settings.notifications,passHref:!0,legacyBehavior:!0,children:(0,s.jsx)(l.N_E,{children:"global preferences"})}),"."]})})]}):(0,s.jsx)(es,{})]})})]})}),O&&(0,s.jsx)(l.tu9,{sx:{p:4},children:(0,s.jsxs)(l.xA9,{container:!0,spacing:3,children:[(0,s.jsx)(l.xA9,{item:!0,sm:4,xs:12,children:(0,s.jsx)(l.o5u,{variant:"h4",sx:{fontWeight:700},children:"Notification"})}),(0,s.jsx)(l.xA9,{item:!0,xs:!0,children:(0,s.jsxs)(l.gE_,{children:[(0,s.jsx)(l.ip9,{control:(0,s.jsx)(l.Sc0,{checked:O[x.E.INCOMING_ETHER]&&O[x.E.INCOMING_TOKEN],disabled:o,onChange:(e,t)=>{I({...O,[x.E.INCOMING_ETHER]:t,[x.E.INCOMING_TOKEN]:t}),(0,S.sx)({...E.j.TOGGLE_INCOMING_TXS,label:t})}}),label:"Incoming transactions"}),(0,s.jsx)(l.ip9,{control:(0,s.jsx)(l.Sc0,{checked:O[x.E.MODULE_TRANSACTION]&&O[x.E.EXECUTED_MULTISIG_TRANSACTION],disabled:o,onChange:(e,t)=>{I({...O,[x.E.MODULE_TRANSACTION]:t,[x.E.EXECUTED_MULTISIG_TRANSACTION]:t}),(0,S.sx)({...E.j.TOGGLE_OUTGOING_TXS,label:t})}}),label:"Outgoing transactions"}),(0,s.jsx)(l.ip9,{control:(0,s.jsx)(l.Sc0,{checked:O[x.E.CONFIRMATION_REQUEST],disabled:o,onChange:(t,n)=>{let s=()=>{I({...O,[x.E.CONFIRMATION_REQUEST]:n}),(0,S.sx)({...E.j.TOGGLE_CONFIRMATION_REQUEST,label:n})};n?A({[e.chainId]:[e.address.value]}).then(e=>{e&&s()}).catch(()=>null):s()}}),label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.o5u,{children:"Confirmation requests"}),!O[x.E.CONFIRMATION_REQUEST]&&(0,s.jsx)(l.o5u,{variant:"body2",sx:{color:"text.secondary"},children:n?"Requires your signature":"Only signers"})]}),disabled:!n||!O})]})})]})})]})};var ef=n(12002);let ev=()=>(0,A.eZ)(ef.Gv.PUSH_NOTIFICATIONS)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i(),{children:(0,s.jsx)("title",{children:"".concat(ei.Az," – Settings – Notifications")})}),(0,s.jsx)(a.A,{}),(0,s.jsx)("main",{children:(0,s.jsx)(ej,{})})]}):null},33462:e=>{e.exports={macOsInfo:"styles_macOsInfo__6sd2_",item:"styles_item__mbLQr",icon:"styles_icon__CfCTp",globalInfo:"styles_globalInfo__FTQds"}},37401:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var s=n(6029);n(55729);var r=n(48230),i=n.n(r),a=n(78726),l=n(89099),o=n(42893),c=n.n(o);let d=e=>{let{tabs:t}=e,n=(0,l.useRouter)(),r=Math.max(0,t.map(e=>e.href).indexOf(n.pathname)),o=n.query.safe?{safe:n.query.safe}:void 0;return(0,s.jsx)(a.tUM,{value:r,variant:"scrollable",allowScrollButtonsMobile:!0,className:c().tabs,children:t.map((e,t)=>(0,s.jsx)(a.ozo,{href:{pathname:e.href,query:o},component:i(),tabIndex:0,className:c().tab,label:(0,s.jsx)(a.o5u,{variant:"body2",fontWeight:700,color:r===t?"primary":"primary.light",className:c().label,children:e.label})},e.href))})}},42893:e=>{e.exports={tabs:"styles_tabs__8AoqD",tab:"styles_tab__WjqMe",label:"styles_label__D53iN"}},44739:(e,t,n)=>{"use strict";var s=n(61307),r=n(17878),i=n(94071),a=s?s.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||r(e)||!!(a&&e&&e[a])}},64285:(e,t,n)=>{"use strict";var s=n(42353),r=n(39665),i=n(5993),a=n(46834),l=n(79849),o=n(2397);e.exports=function(e,t,n,c){var d=-1,u=r,h=!0,x=e.length,j=[],f=t.length;if(!x)return j;n&&(t=a(t,l(n))),c?(u=i,h=!1):t.length>=200&&(u=o,h=!1,t=new s(t));e:for(;++d<x;){var v=e[d],p=null==n?v:n(v);if(v=c||0!==v?v:0,h&&p==p){for(var b=f;b--;)if(t[b]===p)continue e;j.push(v)}else u(t,p,c)||j.push(v)}return j}},78437:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var s=n(6029),r=n(85235),i=n(32988),a=n.n(i),l=n(97114),o=n.n(l);let c=e=>{let{title:t,action:n,noBorder:i}=e;return(0,s.jsxs)(r.azJ,{className:a()(o().container,{[o().border]:!i}),children:[(0,s.jsx)(r.o5u,{variant:"h3",className:o().title,children:t}),n]})}},85495:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var s=n(6029),r=n(37401),i=n(78437),a=n(23084),l=n(97114),o=n.n(l),c=n(57910),d=n(30697),u=n(7717);let h=(0,n(77978).A)(e=>{let{safeAddress:t,chain:n}=e,l=t?a.Zt.filter(e=>(0,u.$I)(e.href,n)):a.r$;return(0,s.jsx)(i.A,{title:t?"Settings":"Preferences",action:(0,s.jsx)("div",{className:o().navWrapper,children:(0,s.jsx)(r.A,{tabs:l})})})},{safeAddress:c.A,chain:d._J})},90270:(e,t,n)=>{"use strict";var s=n(89688),r=n(42411),i=n(36039);e.exports=function(e,t){var n={};return t=i(t,3),r(e,function(e,r,i){s(n,r,t(e,r,i))}),n}},97114:e=>{e.exports={container:"styles_container__sGid8",title:"styles_title___s0jt",border:"styles_border__BkX1U",pageHeader:"styles_pageHeader__fRL7d",actionsWrapper:"styles_actionsWrapper__g_Tq2",navWrapper:"styles_navWrapper__XNqgs"}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(5404)),_N_E=e.O()}]);
//# sourceMappingURL=notifications-29d21330cbc6a8d1.js.map